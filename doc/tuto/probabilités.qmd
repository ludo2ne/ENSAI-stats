---
title: "Probabilité"
description: "Concepts basiques de probabilité"
author: "Ludovic Deneuville"
format:
  html:
    toc: true
    toc-location: left
    toc-expand: 3
    df-print: paged
    code-fold: true
fig-width: 6
fig-height: 4
fig-align: center
from: markdown+emoji
number-sections: true
---

## Loi des grands nombres

### Énoncé

Soit $(X_n)_{n\geq1}$ une suite de variables aléatoires iid à valeurs dans $\mathbb{R}^d$. Alors, la moyenne empirique converge presque sûrement vers l'espérance de $X_1$ lorsque $n$ tend vers l'infini :

$$\lim_{n \to +\infty} \frac{1}{n} \sum_{i=1}^{n} X_i = \mathbb{E}(X_1) \quad \text{p.s.}$$


### Exemple

```{r}
library(ggplot2)

# Simuler les lancers de dés
n <- 500
ech <- sample(x = 1:6, size = n, replace = TRUE)
data <- data.frame(x = 1:n, 
                   p = sapply(1:n, 
                              function(i) mean(ech[1:i])))

# Tracer le graphique avec ggplot2
ggplot(data, aes(x = x, y = p)) +
  geom_hline(yintercept = 3.5, 
             color = "orange", 
             linetype = "dashed",
             linewidth = 1.1) +
  geom_line(color = "darkcyan", linewidth = 1.2) +
  labs(title = "Moyenne des lancers de dé",
       x = "Nombre de lancers",
       y = "Moyenne") +
  xlim(0, n) +
  ylim(0, 6)
```


## Théorème Centrale Limite

### énoncé

Soit $(X_n)_{n\geq1}$ une suite de variables aléatoires indépendantes et identiquement distribuées (iid) avec une moyenne $\mu$ et un écart-type $\sigma$. Alors, lorsque $n$ tend vers l'infini, la distribution de la moyenne $\bar{X}_n$ de ces variables aléatoires suit approximativement une loi normale avec une moyenne $\mu$ et un écart-type $\frac{\sigma}{\sqrt{n}}$. Formellement,

$$\lim_{n \to +\infty} \sqrt{n} \left( \frac{1}{n}\sum_{i=1}^{n} \frac{ X_i - \mu}{\sigma} \right) \xrightarrow{\mathcal {L}} N(0, 1)$$


### Exemple

```{r}
library(ggplot2)

nb_sim <- 5000
taille_ech <- 50
u_min <- 0
u_max <- 1
E <- (u_max - u_min) / 2
V <- (u_max - u_min)^2 / 12

# Simulations
res <- numeric(nb_sim)
for (i in 1:nb_sim) {
  ech <- runif(taille_ech, min = u_min, max = u_max)
  res[i] <- sqrt(taille_ech) / sqrt(V) * (mean(ech) - E)
}
df <- data.frame(res)

# Tracé de l'histogramme et de la densité
ggplot(df, aes(x = res)) +
  geom_histogram(binwidth = 0.2, 
                 fill = "darkcyan", 
                 color = "black", 
                 aes(y = after_stat(density))) +
  stat_function(aes(linetype = "N(0,1)"), 
                fun = dnorm, 
                args = list(mean = 0, sd = sd(df$res)), 
                color = "orange", 
                linewidth = 1.5) +  # Courbe de densité normale
  labs(title = "Distribution des moyennes des échantillons simulés selon une loi uniforme",
       x = "Moyenne des échantillons",
       y = "Densité") +
  scale_linetype_manual(name = "Distribution", 
                        values = "dashed",
                        labels = c("N(0,1)")) +
  theme_minimal()
```